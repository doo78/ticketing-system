{% extends 'staff/base.html' %}

{% block content %}
{% block body %}
{% if not email_verified %}
    <div class="alert alert-warning" role="alert">
        Please verify your email address to access all features.
    </div>
{% endif %}
<div class="container-fluid">
    <!-- Welcome Section -->
    <div class="welcome-container text-center py-5">
        <h1 class="fw-bold">Welcome, {{ request.user.get_full_name|default:request.user.username }}</h1>
        <p class="lead text-muted">Your Staff Dashboard</p>
    </div>

    <!-- Stats Row -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <h5 class="card-title">My Assigned Tickets</h5>
                    <h2 class="card-text">{{ assigned_tickets_count|default:"0" }}</h2>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <h5 class="card-title">My Department Tickets</h5>
                    <h2 class="card-text">{{ department_tickets_count|default:"0" }}</h2>
                    {% if unassigned_dept_tickets > 0 %}
                    <p class="mb-0"><span class="badge bg-danger">{{ unassigned_dept_tickets }} unassigned</span></p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card bg-secondary text-white">
                <div class="card-body">
                    <h5 class="card-title">Department</h5>
                    <h2 class="card-text">{{ department }}</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Quick Actions</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex gap-3">
                        <a href="{% url 'staff_ticket_list' %}" class="btn btn-primary">
                            <i class="bi bi-ticket-detailed me-2"></i>View All Tickets
                        </a>
                        <a href="{% url 'staff_ticket_list' %}?department_filter=mine" class="btn btn-info">
                            <i class="bi bi-filter me-2"></i>My Department Tickets
                        </a>
                        {% if unassigned_dept_tickets > 0 %}
                        <a href="{% url 'staff_ticket_list' %}?department_filter=mine&status=open" class="btn btn-danger">
                            <i class="bi bi-exclamation-circle me-2"></i>Unassigned Department Tickets ({{ unassigned_dept_tickets }})
                        </a>
                        {% endif %}
                        <a href="{% url 'staff_profile' %}" class="btn btn-outline-secondary">
                            <i class="bi bi-person-circle me-2"></i>My Profile
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Custom CSS -->
<style>
    .bg-gradient-primary {
        background: linear-gradient(135deg, #6a11cb, #2575fc);
    }

    .bg-gradient-secondary {
        background: linear-gradient(135deg, #ff7eb3, #ff758c);
    }

    .card {
        border-radius: 15px;
    }

    .btn-lg {
        font-size: 1.2rem;
        font-weight: bold;
        transition: transform 0.2s ease-in-out;
    }

    .btn-lg:hover {
        transform: scale(1.05);
    }
</style>

{% endblock %}